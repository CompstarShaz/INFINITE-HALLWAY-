<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=0.8">
<title>HTML File Gallery â€“ Glass UI</title>
<style>
:root{
  --accent:#66fffa;
  --bg-dark:#111;
  --bg-light:#f5f5f5;
  --glass:rgba(255,255,255,0.08);
}
body{
  margin:5px;
  font-family:Arial,Helvetica,sans-serif;
  background:var(--bg-dark);
  color:#fff;
  overflow:hidden;
  transition:background .3s,color .3s;
}
body.light{background:var(--bg-light);color:#111;}
/* ---------- GLASS BUTTONS ---------- */
.glass-btn{
  padding:6px 10px;
  font-size:16px;
  border:none;
  border-radius:10px;
  color:#fff;
  background:var(--glass);
  backdrop-filter:blur(6px) saturate(180%);
  box-shadow:0 3px 6px rgba(0,0,0,0.5),0 0 10px rgba(255,255,255,0.05) inset;
  transition:all .25s;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}
.glass-btn img{height:32px;width:32px;pointer-events:none;}
.glass-btn:hover{transform:scale(1.1);background:rgba(255,255,255,0.25);}
body.light .glass-btn{color:#111;background:rgba(255,255,255,0.4);}
body.light .glass-btn:hover{background:rgba(255,255,255,0.6);}

/* ---------- HEADER ---------- */
header{
  height:7vh;
  display:flex;
  align-items:center;
  justify-content:flex-start;
  gap:8px;
  background:rgba(17,17,17,0.6);
  backdrop-filter:blur(10px);
  position:relative;
  z-index:10;
  border-radius:12px;
  box-shadow:0 0 12px rgba(0,0,0,0.6);
  padding:0 10px;
  overflow:hidden;
  flex-wrap:nowrap;
}
header .glass-btn{
  flex-shrink:1;
  min-width:38px;
  max-width:44px;
  aspect-ratio:1/1;
  display:flex;
  justify-content:center;
  align-items:center;
}
header img{height:28px;width:28px;}
header label{
  display:flex;
  align-items:center;
  gap:4px;
  font-size:14px;
  flex-shrink:1;
}
#speedBox{
  width:40px;text-align:center;
  border-radius:6px;
  border:1px solid #999;
  background:rgba(255,255,255,0.1);
  color:#fff;
  padding:2px;
}
body.light #speedBox{color:#111;background:rgba(255,255,255,0.7);}
#fullscreenGroup{
  display:flex;
  align-items:center;
  gap:4px;
  margin-left:auto;
}
#fullscreenNote{
  opacity:0;
  color:var(--accent);
  font-size:13px;
  animation:blink 1.2s infinite;
  transition:opacity 0.8s ease;
  pointer-events:none;
}
@keyframes blink { 50% {opacity:0.3;} }

/* Responsive shrink */
@media (max-width:700px){
  header{gap:4px;padding:0 6px;}
  header .glass-btn{min-width:32px;max-width:36px;}
  header img{height:24px;width:24px;}
  #speedBox{width:32px;font-size:12px;}
}

/* ---------- MAIN PREVIEW ---------- */
#mainPreview{
  height:80vh;
  display:flex;
  justify-content:center;
  align-items:center;
  position:relative;
  border:6px double var(--accent);
  box-shadow:0 0 20px var(--accent),0 0 50px var(--accent) inset;
  background:#1d1d1d;
  border-radius:14px;
  overflow:hidden;
}
#mainFrame{
  width:96%;height:96%;border:none;
  opacity:0;transition:opacity .6s;
}
#mainFrame.visible{opacity:1;}
/* File counter in top-right */
#cornerCounter{
  position:absolute;
  top:8px;right:12px;
  font-size:15px;
  font-weight:bold;
  color:var(--accent);
  text-shadow:0 0 8px var(--accent);
  background:rgba(0,0,0,0.4);
  padding:3px 8px;
  border-radius:8px;
  z-index:20;
}

/* Tap zones */
.sideZone{
  position:absolute;
  top:0;
  width:10%;
  height:100%;
  z-index:5;
  cursor:pointer;
  background:transparent;
}
#leftZone{left:0;}
#rightZone{right:0;}

/* ---------- FULLSCREEN CONTROLS ---------- */
#fullscreenControls{
  position:absolute;top:10px;left:10px;
  display:flex;gap:6px;z-index:100;
}
#fullscreenControls .glass-btn{padding:6px 10px;font-size:16px;}
#mainPreview:fullscreen{
  border:6px solid var(--accent);
  box-shadow:0 0 40px var(--accent),0 0 100px var(--accent) inset;
  border-radius:0;
}

/* ---------- BOTTOM LIST ---------- */
#bottomBar{
  height:15vh;
  background:rgba(30,30,30,0.9);
  overflow-x:auto;
  white-space:nowrap;
  display:flex;
  align-items:center;
  gap:15px;
  padding:0 20px;
  border-radius:10px;
  backdrop-filter:blur(6px);
}
.filename{
  flex:0 0 auto;
  padding:8px 14px;
  border-radius:6px;
  background:#333;
  cursor:pointer;
  transition:all .3s;
  font-size:12px;
}
.filename.active{
  background:var(--accent);
  color:#000;
  transform:scale(1.15);
}
#navButtons{
  position:absolute;
  top:50%;
  width:100%;
  display:flex;
  justify-content:space-between;
  transform:translateY(-50%);
  pointer-events:none;
}
#navButtons img{
  height:50px;width:50px;
  opacity:0.5;
  pointer-events:auto;
  cursor:pointer;
  transition:transform .2s,opacity .3s;
}
#navButtons img:hover{opacity:1;transform:scale(1.1);}
#bottomButtons{
  position:fixed;bottom:10px;right:10px;
  display:flex;gap:8px;z-index:100;
}
</style>
</head>
<body>

<header>
  <button class="glass-btn" id="openFilesBtn" title="Open Files"><img src="assets/open.png" alt="open"></button>
  <button class="glass-btn" id="downloadBtn" title="Download"><img src="assets/download.png" alt="download"></button>
  <button class="glass-btn" id="deleteBtn" title="Delete"><img src="assets/delete.png" alt="delete"></button>
  <button class="glass-btn" id="autoBtn" title="Auto Play"><img src="assets/auto.png" alt="auto"></button>
  <button class="glass-btn" id="pauseBtn" title="Pause"><img src="assets/pz.png" alt="pause"></button>
  <button class="glass-btn" id="themeBtn" title="Switch Theme"><img src="assets/theme.png" alt="theme"></button>
  <label>Speed <input type="number" id="speedBox" value="5" min="1" max="10"></label>
  <div id="fullscreenGroup">
    <button class="glass-btn" id="fullscreenToggle" title="Fullscreen"><img src="assets/full.png" alt="fullscreen"></button>
    <span id="fullscreenNote">Tap to enter Fullscreen</span>
  </div>
</header>

<div id="mainPreview">
  <div id="cornerCounter">0 / 0</div>

  <!-- Invisible side click zones -->
  <div class="sideZone" id="leftZone"></div>
  <div class="sideZone" id="rightZone"></div>

  <iframe id="mainFrame" srcdoc="<p style='color:#fff;text-align:center;'>Select HTML files</p>"></iframe>

  <div id="navButtons">
    <img id="prevBtn" src="assets/left.png" alt="prev">
    <img id="nextBtn" src="assets/right.png" alt="next">
  </div>

  <div id="fullscreenControls">
    <button class="glass-btn" id="exitFullscreenBtn">X</button>
    <button class="glass-btn" id="fsDownloadBtn"><img src="assets/dl.png" alt="download"></button>
    <button class="glass-btn" id="toggleSlideBtn"><img src="assets/pz.png" alt="pause"></button>
    <button class="glass-btn" id="fsPrevBtn"><img src="assets/Back.png" alt="prev"></button>
    <button class="glass-btn" id="fsNextBtn"><img src="assets/Next.png" alt="next"></button>
  </div>
</div>

<div id="bottomBar"></div>

<div id="bottomButtons">
  <button class="glass-btn" id="copyBtn"><img src="assets/cpy.png" alt="copy"></button>
  <button class="glass-btn" id="shareBtn"><img src="assets/share.png" alt="share"></button>
</div>

<input type="file" id="fileInput" accept=".html" multiple style="display:none">

<script>
let files=[],currentIndex=0,isLight=false,autoSlide=false,slideInterval=null;
const mainFrame=document.getElementById('mainFrame');
const bottomBar=document.getElementById('bottomBar');
const cornerCounter=document.getElementById('cornerCounter');
const qs=id=>document.getElementById(id);

const openFilesBtn=qs('openFilesBtn'),fileInput=qs('fileInput'),
downloadBtn=qs('downloadBtn'),fsDownloadBtn=qs('fsDownloadBtn'),
deleteBtn=qs('deleteBtn'),autoBtn=qs('autoBtn'),pauseBtn=qs('pauseBtn'),
themeBtn=qs('themeBtn'),fullscreenToggle=qs('fullscreenToggle'),
exitFullscreenBtn=qs('exitFullscreenBtn'),toggleSlideBtn=qs('toggleSlideBtn'),
copyBtn=qs('copyBtn'),shareBtn=qs('shareBtn'),speedBox=qs('speedBox'),
prevBtn=qs('prevBtn'),nextBtn=qs('nextBtn'),
fsPrevBtn=qs('fsPrevBtn'),fsNextBtn=qs('fsNextBtn'),
leftZone=qs('leftZone'),rightZone=qs('rightZone');

function saveState(){
  localStorage.setItem('viewerIndex',currentIndex);
  localStorage.setItem('viewerTheme',isLight?'light':'dark');
}
function restoreState(){
  isLight=(localStorage.getItem('viewerTheme')==='light');
  document.body.classList.toggle('light',isLight);
}

openFilesBtn.onclick=()=>fileInput.click();
themeBtn.onclick=()=>{
  isLight=!isLight;
  document.body.classList.toggle('light',isLight);
  saveState();
};

fileInput.onchange=e=>{
  files=[...e.target.files].filter(f=>f.name.endsWith('.html'));
  currentIndex=parseInt(localStorage.getItem('viewerIndex')||0);
  renderList();
  showMain(currentIndex);
};

function renderList(){
  bottomBar.innerHTML='';
  files.forEach((f,i)=>{
    const btn=document.createElement('div');
    btn.className='filename';
    btn.textContent=f.name;
    btn.onclick=()=>{showMain(i);saveState();}
    bottomBar.appendChild(btn);
  });
  updateActive();
}

function showMain(i){
  if(!files[i])return;
  currentIndex=i;
  const reader=new FileReader();
  reader.onload=e=>{
    mainFrame.classList.remove('visible');
    setTimeout(()=>{
      mainFrame.srcdoc=e.target.result;
      mainFrame.classList.add('visible');
    },150);
  };
  reader.readAsText(files[i]);
  updateActive();
  updateCounter();
  saveState();
}
function updateActive(){
  document.querySelectorAll('.filename').forEach((el,idx)=>{
    el.classList.toggle('active',idx===currentIndex);
  });
}
function updateCounter(){
  cornerCounter.textContent=`${files.length?currentIndex+1:0} / ${files.length}`;
}

function nextFile(){
  if(!files.length)return;
  currentIndex=(currentIndex+1)%files.length;
  showMain(currentIndex);
}
function prevFile(){
  if(!files.length)return;
  currentIndex=(currentIndex-1+files.length)%files.length;
  showMain(currentIndex);
}
nextBtn.onclick=nextFile;prevBtn.onclick=prevFile;
fsNextBtn.onclick=nextFile;fsPrevBtn.onclick=prevFile;
rightZone.onclick=nextFile;leftZone.onclick=prevFile;

deleteBtn.onclick=()=>{
  if(!files.length)return;
  if(confirm(`Delete "${files[currentIndex].name}" from gallery?`)){
    files.splice(currentIndex,1);
    if(currentIndex>=files.length)currentIndex=files.length-1;
    if(files.length>0)showMain(currentIndex);
    else mainFrame.srcdoc="<p>No files left.</p>";
    renderList();
    updateCounter();
  }
};

function downloadCurrent(){
  const file=files[currentIndex]; if(!file)return;
  const r=new FileReader();
  r.onload=e=>{
    const blob=new Blob([e.target.result],{type:'text/html'});
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download=file.name;a.click();
  };
  r.readAsText(file);
}
downloadBtn.onclick=downloadCurrent;fsDownloadBtn.onclick=downloadCurrent;

fullscreenToggle.onclick=()=>{if(!document.fullscreenElement)qs('mainPreview').requestFullscreen();};
exitFullscreenBtn.onclick=()=>document.exitFullscreen();

autoBtn.onclick=()=>startAutoSlide();
pauseBtn.onclick=()=>stopAutoSlide();
toggleSlideBtn.onclick=()=>{
  if(autoSlide){stopAutoSlide();toggleSlideBtn.firstChild.src='assets/play.png';}
  else{startAutoSlide();toggleSlideBtn.firstChild.src='assets/pz.png';}
};

function startAutoSlide(){
  stopAutoSlide();
  const interval=Math.max(1,Math.min(10,parseInt(speedBox.value)||5))*1000;
  autoSlide=true;
  slideInterval=setInterval(nextFile,interval);
}
function stopAutoSlide(){autoSlide=false;if(slideInterval)clearInterval(slideInterval);}

copyBtn.onclick=()=>{
  const f=files[currentIndex];if(!f)return;
  const r=new FileReader();
  r.onload=e=>navigator.clipboard.writeText(e.target.result);
  r.readAsText(f);
};
shareBtn.onclick=()=>{
  const f=files[currentIndex];if(!f)return;
  const r=new FileReader();
  r.onload=e=>{
    const blob=new Blob([e.target.result],{type:'text/html'});
    if(navigator.canShare && navigator.canShare({files:[new File([blob],f.name,{type:'text/html'})]}))
      navigator.share({files:[new File([blob],f.name,{type:'text/html'})],title:f.name});
    else alert('Sharing not supported');
  };
  r.readAsText(f);
};

// Restore saved theme immediately
restoreState();

// --- Fullscreen note behavior ---
const fullscreenNote=document.getElementById('fullscreenNote');
let noteTimer=null, noteVisible=false;
function showFullscreenNote(){
  if(noteVisible)return;
  fullscreenNote.style.opacity=1;
  noteVisible=true;
}
function hideFullscreenNote(){
  fullscreenNote.style.opacity=0;
  noteVisible=false;
  clearTimeout(noteTimer);
  noteTimer=setTimeout(showFullscreenNote,5000);
}
document.addEventListener('mousemove',hideFullscreenNote);
document.addEventListener('click',hideFullscreenNote);
hideFullscreenNote(); // start timer
</script>
</body>
</html>
